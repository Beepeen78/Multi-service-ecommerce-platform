================================================================================
                    MULTI-SERVICE E-COMMERCE PLATFORM
                        ARCHITECTURE DIAGRAMS
================================================================================

┌─────────────────────────────────────────────────────────────────────────────┐
│                        1. HIGH-LEVEL ARCHITECTURE                           │
└─────────────────────────────────────────────────────────────────────────────┘

                        ┌─────────────────┐
                        │  Web Browser    │
                        │  Mobile App     │
                        │  (Clients)      │
                        └────────┬────────┘
                                 │
                                 │ HTTPS/REST API
                                 │
                    ┌────────────▼────────────┐
                    │                         │
                    │     API GATEWAY         │
                    │   (Port 8080)           │
                    │  • Request Routing      │
                    │  • Load Balancing       │
                    │  • CORS Handling        │
                    │                         │
                    └────────────┬────────────┘
                                 │
        ┌────────────────────────┼────────────────────────┐
        │                        │                        │
   ┌────▼────┐             ┌─────▼──────┐          ┌─────▼─────┐
   │  USER   │             │  PRODUCT   │          │   ORDER   │
   │ SERVICE │             │  SERVICE   │          │  SERVICE  │
   │ :3001   │             │   :3002    │          │   :3003   │
   │         │             │            │          │           │
   │ • Auth  │             │ • Catalog  │          │ • Orders  │
   │ • Users │             │ • CRUD     │          │ • Status  │
   └────┬────┘             └─────┬──────┘          └─────┬─────┘
        │                        │                        │
        │                        │                        │
   ┌────┴────────────────────────┴────────────────────────┴────┐
   │                                                             │
   │                  POSTGRESQL DATABASE                        │
   │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐      │
   │  │ecommerce_    │ │ecommerce_    │ │ecommerce_    │      │
   │  │users         │ │products      │ │orders        │      │
   │  └──────────────┘ └──────────────┘ └──────────────┘      │
   │                                                             │
   └───────────────────────────┬─────────────────────────────────┘
                               │
                      ┌────────▼────────┐
                      │  REDIS CACHE    │
                      │   (Port 6379)   │
                      │  • Sessions     │
                      │  • Cache        │
                      └─────────────────┘


┌─────────────────────────────────────────────────────────────────────────────┐
│                     2. SERVICE DEPLOYMENT VIEW                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────┐
│                         DOCKER COMPOSE NETWORK                            │
│                                                                           │
│  ┌────────────────────────────────────────────────────────────────┐     │
│  │                    ecommerce-network                           │     │
│  │                                                                 │     │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐        │     │
│  │  │ API Gateway  │  │ User Service │  │Product Service│        │     │
│  │  │   :8080      │  │   :3001      │  │    :3002      │        │     │
│  │  └──────────────┘  └──────────────┘  └──────────────┘        │     │
│  │                                                                 │     │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐        │     │
│  │  │Order Service │  │  PostgreSQL  │  │    Redis     │        │     │
│  │  │   :3003      │  │   :5432      │  │    :6379     │        │     │
│  │  └──────────────┘  └──────────────┘  └──────────────┘        │     │
│  │                                                                 │     │
│  └────────────────────────────────────────────────────────────────┘     │
│                                                                           │
│  External Access (localhost):                                            │
│  • localhost:8080 → API Gateway                                          │
│  • localhost:3001 → User Service                                         │
│  • localhost:3002 → Product Service                                      │
│  • localhost:3003 → Order Service                                        │
│                                                                           │
└──────────────────────────────────────────────────────────────────────────┘


┌─────────────────────────────────────────────────────────────────────────────┐
│                       3. REQUEST FLOW EXAMPLE                               │
│                      (Creating an Order)                                    │
└─────────────────────────────────────────────────────────────────────────────┘

Step 1: Client Request
   Client
     │
     │ POST /api/orders
     │ Headers: Authorization: Bearer <token>
     │ Body: { items: [{product_id: 1, quantity: 2}] }
     │
     ▼
   API Gateway (Port 8080)

Step 2: Routing
   API Gateway
     │
     │ Routes to Order Service
     │ Rewrites path: /api/orders → /
     │
     ▼
   Order Service (Port 3003)

Step 3: Authentication
   Order Service
     │
     │ Validates JWT Token
     │
     ├─→ GET /profile
     │   Headers: Authorization: Bearer <token>
     │
     ▼
   User Service (Port 3001)
     │
     │ Returns: { user: { id: 1, email: "..." } }
     │
     ▼
   Order Service (verified user ID: 1)

Step 4: Product Validation
   Order Service
     │
     │ For each item:
     │
     ├─→ GET /1  (product_id: 1)
     │
     ▼
   Product Service (Port 3002)
     │
     │ Returns: { product: { id: 1, name: "Laptop", price: 999, stock: 10 } }
     │
     ▼
   Order Service (validates stock, calculates total)

Step 5: Order Creation
   Order Service
     │
     │ BEGIN TRANSACTION
     │   INSERT INTO orders (user_id, total_amount, status)
     │   INSERT INTO order_items (order_id, product_id, quantity, price)
     │ COMMIT
     │
     ▼
   PostgreSQL Database (ecommerce_orders)
     │
     │ Returns: Order created with ID
     │
     ▼
   Order Service

Step 6: Response
   Order Service
     │
     │ Returns: { order: { id: 1, total_amount: 1998, items: [...] } }
     │
     ▼
   API Gateway
     │
     │ Returns response to client
     │
     ▼
   Client (receives order confirmation)


┌─────────────────────────────────────────────────────────────────────────────┐
│                       4. DATABASE ARCHITECTURE                              │
└─────────────────────────────────────────────────────────────────────────────┘

                    ┌─────────────────────┐
                    │   PostgreSQL        │
                    │   (Port 5432)       │
                    └──────────┬──────────┘
                               │
        ┌──────────────────────┼──────────────────────┐
        │                      │                      │
   ┌────▼──────┐        ┌──────▼──────┐        ┌─────▼─────┐
   │  Database │        │  Database   │        │  Database │
   │  USERS    │        │  PRODUCTS   │        │  ORDERS   │
   └───────────┘        └─────────────┘        └───────────┘
        │                      │                      │
        │                      │                      │
   ┌────▼─────┐          ┌─────▼────┐          ┌─────▼─────┐
   │  users   │          │ products │          │  orders   │
   │  table   │          │  table   │          │  table    │
   │          │          │          │          │           │
   │          │          │          │          │  order_   │
   │          │          │          │          │  items    │
   │          │          │          │          │  table    │
   └──────────┘          └──────────┘          └───────────┘


┌─────────────────────────────────────────────────────────────────────────────┐
│                     5. KUBERNETES DEPLOYMENT                                │
└─────────────────────────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────┐
│                      Kubernetes Cluster                            │
│                                                                    │
│  ┌────────────────────────────────────────────────────────────┐  │
│  │              Namespace: ecommerce-platform                  │  │
│  │                                                             │  │
│  │  ┌──────────────────────────────────────────────────────┐ │  │
│  │  │          API Gateway Service                         │ │  │
│  │  │          Replicas: 2                                 │ │  │
│  │  │          Type: LoadBalancer                          │ │  │
│  │  │          Port: 80 → 8080                             │ │  │
│  │  └──────────────────────────────────────────────────────┘ │  │
│  │                                                             │  │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐                │  │
│  │  │   User   │  │ Product  │  │  Order   │                │  │
│  │  │ Service  │  │ Service  │  │ Service  │                │  │
│  │  │(2 pods)  │  │(2 pods)  │  │(2 pods)  │                │  │
│  │  │ClusterIP │  │ClusterIP │  │ClusterIP │                │  │
│  │  └──────────┘  └──────────┘  └──────────┘                │  │
│  │                                                             │  │
│  │  ┌──────────┐  ┌──────────┐                              │  │
│  │  │PostgreSQL│  │  Redis   │                              │  │
│  │  │(1 pod)   │  │(1 pod)   │                              │  │
│  │  │ PVC:10GB │  │ PVC:5GB  │                              │  │
│  │  └──────────┘  └──────────┘                              │  │
│  │                                                             │  │
│  │  ┌──────────┐  ┌──────────┐                              │  │
│  │  │ ConfigMap│  │ Secrets  │                              │  │
│  │  │ (Config) │  │ (Tokens) │                              │  │
│  │  └──────────┘  └──────────┘                              │  │
│  │                                                             │  │
│  └─────────────────────────────────────────────────────────────┘  │
│                                                                    │
└────────────────────────────────────────────────────────────────────┘


┌─────────────────────────────────────────────────────────────────────────────┐
│                     6. TECHNOLOGY STACK LAYERS                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│                        PRESENTATION LAYER                       │
│  • Web Browser / Mobile App                                     │
│  • REST API Clients                                             │
└─────────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────────┐
│                        API GATEWAY LAYER                        │
│  • Express.js                                                   │
│  • http-proxy-middleware                                        │
│  • CORS, Routing, Load Balancing                                │
└─────────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────────┐
│                      BUSINESS LOGIC LAYER                       │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐      │
│  │   User   │  │ Product  │  │  Order   │  │ Payment  │      │
│  │ Service  │  │ Service  │  │ Service  │  │ Service  │      │
│  │          │  │          │  │          │  │          │      │
│  │ Express  │  │ Express  │  │ Express  │  │ Express  │      │
│  │ TypeScript│ │ TypeScript│ │ TypeScript│ │ TypeScript│     │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘      │
└─────────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────────┐
│                        DATA LAYER                               │
│  ┌──────────────┐          ┌──────────────┐                   │
│  │  PostgreSQL  │          │    Redis     │                   │
│  │  (Primary DB)│          │   (Cache)    │                   │
│  └──────────────┘          └──────────────┘                   │
└─────────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────────┐
│                      INFRASTRUCTURE LAYER                       │
│  • Docker (Containers)                                          │
│  • Docker Compose (Orchestration)                               │
│  • Kubernetes (Production)                                      │
│  • GitHub Actions (CI/CD)                                       │
└─────────────────────────────────────────────────────────────────┘


================================================================================
                           END OF DIAGRAMS
================================================================================

